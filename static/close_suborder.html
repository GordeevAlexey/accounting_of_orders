<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Закрытие поручения</title>

<style>
            <style>

            body {
                background-color: white;
                 }

            img {
            width: 250px;
            align: center;
                }

            p {
            font-family: sans-serif;
            font-size: 30px;
            text-align: center
            }

            form {
                text-align:center;
                 }

            h1, label{
                font-variant: small-caps;
                color: rgba(0, 0, 153,.7)
                }

            orders {
            font-variant: small-caps;
            }

            .btn, input, select {
                font-variant: small-caps;
                width:400px;
                padding:18px;
                border-radius: 10px;
                border:0;
                box-shadow:0 0 15px 2px rgba(60,74,123,.7);
                border-bottom:1px ;
                box-sizing: border-box;
                margin:8px
            }

            textarea{
                font-family: Verdana;
                font-size: 30;
                width:400px;
                height:400px;
                padding:18px;
                border-radius: 10px;
                border:0;
                box-shadow:0 0 15px 2px rgba(60,74,123,.7);
                border-bottom:1px ;
                box-sizing: border-box;
                margin:8px
            }

<!--            input:hover, input:focus,-->
<!--            button:hover, button:focus,-->
<!--            select:hover, select:focus {-->
<!--                box-shadow:0 0 15px 2px rgba(60,123,68,.7);-->
<!--                background: rgba(60,123,68,.1);-->
<!--                outline:0;-->
<!--            }-->

</style>
    <script src ="{{ url_for('static', path='lib/jquery.min.js')}}"></script>
<!--    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>-->
</head>

<body>

    <table id="order_table" style="float: left">
        <tr>
            <td></td>
            <td><h1 style="text-align: left">Информация о приказе</h1></td>
        </tr>
        <tr>
            <td><label for="issue_type">Вид поручения</label></td>
            <td><input type="text" id="issue_type" readonly></td>
        </tr>
        <tr>
            <td><label for="issue_idx">Номер приказа</label></td>
            <td><input type="text" id="issue_idx" readonly></td>
        </tr>
        <tr>
            <td><label for="approving_date">Дата утверждения</label></td>
            <td><input type="date" id="approving_date" readonly></td>
        </tr>

        <tr>
            <td><label for="title">Тема</label></td>
            <td><textarea style="height:60px" type="text" id="title" readonly></textarea></td>
        </tr>
        <tr>
            <td><label for="initiator">Инициатор</label></td>
            <td><input type="text" id="initiator" readonly></td>
        </tr>
        <tr>
            <td><label for="approving_employee">Утверждающий руководитель</label></td>
            <td><input type="text" id="approving_employee" readonly></td>
        </tr>
        <tr>
            <td><label for="employee_order">Ответственный исполнитель</label></td>
            <td><input type="text" id="employee_order" readonly></td>
        </tr>
        <tr>
            <td><label for="deadline">Срок исполнения приказа</label></td>
            <td><input type="date" id="deadline" readonly></td>
        </tr>
        <tr>
            <td><label for="comment">Коментарии</label></td>
            <td><textarea style="height:60px" type="text" id="comment" readonly></textarea></td>
        </tr>
        <tr>
             <td><p><a href="" id="reference">Приказ</a></p></td>
        </tr>
    </table>

    <table id="suborder_table" style="float: left">
        <tr>
            <td></td>
            <td><h1 style="text-align: left">Информация о поручении</h1></td>
        </tr>
        <tr>
            <td><label for="employee_sub_order">Исполнитель</label></td>
            <td><input type="text" id="employee_sub_order" readonly></td>
        </tr>
        <tr>
            <td><label for="deadline_suborder">Срок исполнения поручения</label></td>
            <td><input type="date" id="deadline_suborder" readonly></td>
        </tr>
        <tr>
            <td><label for="status_code">Статус поручения</label></td>
            <td><input type="text" id="status_code" readonly></td>
        </tr>
        <tr>
            <td><label for="content">Текст поручения</label></td>
            <td><textarea style="height:130px" type="text" id="content" readonly></textarea></td>
        </tr>

    <form action="" id="close_suborder_form" method="post" onsubmit="return addActionForm('close_suborder_form', 'closing_by_the_performer');">
        <tr>
            <td><label for="comment_suborder">Комментарии</label></td>
            <td><textarea name="comment_suborder" id="comment_suborder" style="height:130px" type="text"></textarea></td>
        </tr>
        <tr>
            <td></td>
            <td><input id="submit_up" type="submit" value="Закрыть поручение" hidden></td>
        </tr>
    </form>

    </table>

    <input name="current_order_id" id="current_order_id" type="text" hidden>
    <input name="current_suborder_id" id="current_suborder_id" type="text" hidden>

<script>

    $(document).ready(function() {

        url = 'http://10.0.2.47:8004/get_info_for_close_suborder/{{ suborder_id }}'
        /* url = 'http://192.168.200.92:8004/get_info_for_close_suborder/{{ suborder_id }}' */
        $.get(url, function(response) {

            var info = JSON.parse(response)[0]

            $("#current_order_id").val(info.id_order);
            $("#current_suborder_id").val(info.id_suborder);
            $("#issue_type").val(info.issue_type);
            $("#issue_idx").val(info.issue_idx);
            $("#approving_date").val(info.approving_date);
            $("#title").val(info.title);
            $("#initiator").val(info.initiator);
            $("#approving_employee").val(info.approving_employee);
            $("#employee_order").val(info.employee_order);
            $("#deadline").val(info.deadline);
            $("#comment").val(info.comment);
            $("#reference").attr("href", info.reference);
            $("#employee_sub_order").val(info.employee_sub_order);
            $("#status_code").val(info.status_code);
            $("#deadline_suborder").val(info.deadline_suborder);
            $("#content").val(info.content);
            $("#comment_suborder").val(info.comment_suborder);

            if (info.status_code == 'На исполнении'){
                $("#submit_up").show(300)
            }
            else {
                $("#submit_up").hide(300)
            }

            });

        });

    function addActionForm() {
        var order_id = escape(document.getElementById('current_order_id').value);
        var suborder_id = escape(document.getElementById('current_suborder_id').value);
        document.getElementById(arguments[0]).action = '/close_suborder/' + order_id + '/' + suborder_id + '/' + arguments[1]
    }


</script>

</body>

</html>


